# دستورالعمل تست سیستم مدیریت طرح‌ها

این سند شامل دستورالعمل‌های کامل برای تست سیستم مدیریت طرح‌ها است.

## پیش‌نیازها

قبل از اجرای تست‌ها، اطمینان حاصل کنید که موارد زیر را انجام داده‌اید:

1. پروژه را مطابق با دستورالعمل‌های README.md نصب و راه‌اندازی کرده‌اید.
2. یک کاربر ادمین ایجاد کرده‌اید.
3. مایگریشن‌ها را اجرا کرده‌اید.

## تست‌های بک‌اند

### اجرای تست‌های اتوماتیک

```bash
# اجرای تمام تست‌ها
cd backend
pytest

# اجرای تست‌های ماژول designs
pytest apps/designs/tests.py

# اجرای تست‌های ماژول auth
pytest apps/auth/tests.py
```

### تست دستی API با Postman یا Curl

#### احراز هویت

1. ثبت‌نام کاربر جدید:
```bash
curl -X POST http://localhost:8000/api/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser", "email":"test@example.com", "password":"testpassword"}'
```

2. ورود و دریافت توکن:
```bash
curl -X POST http://localhost:8000/api/auth/token/ \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser", "password":"testpassword"}'
```

#### API طرح‌ها

1. دریافت لیست طرح‌ها:
```bash
curl -X GET http://localhost:8000/api/designs/designs/ \
  -H "Authorization: Bearer YOUR_TOKEN"
```

2. ایجاد طرح جدید:
```bash
curl -X POST http://localhost:8000/api/designs/designs/ \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: multipart/form-data" \
  -F "title=طرح تست" \
  -F "description=این یک طرح تست است" \
  -F "product_image=@/path/to/image.jpg"
```

## تست‌های فرانت‌اند

### اجرای تست‌های اتوماتیک

```bash
cd frontend
npm test
```

### تست دستی UI

#### احراز هویت

1. به آدرس `http://localhost:3000/login` بروید.
2. ورود با کاربر تست یا ادمین را امتحان کنید.
3. بررسی کنید که پس از ورود موفق، به داشبورد هدایت شوید.
4. گزینه ثبت‌نام را امتحان کنید.

#### مدیریت طرح‌ها

1. به لیست طرح‌ها در `http://localhost:3000/designs` بروید.
2. ویجت طرح‌های اخیر در داشبورد را بررسی کنید.
3. ایجاد طرح جدید را با مراجعه به `http://localhost:3000/designs/create` امتحان کنید.
4. آپلود دسته‌ای را با مراجعه به `http://localhost:3000/designs/batch-upload` امتحان کنید.
5. روی یک طرح کلیک کنید تا جزئیات آن را ببینید.
6. ویرایش و حذف طرح را امتحان کنید.

#### دسترسی‌های کاربری

1. با یک کاربر غیر ادمین وارد شوید.
2. بررسی کنید که آیا به بخش مدیریت کاربران دسترسی دارید یا خیر.
3. با یک کاربر ادمین وارد شوید.
4. بررسی کنید که آیا به تمام بخش‌ها دسترسی دارید یا خیر.

## موارد رایج خطا و رفع اشکال

1. **خطای CORS**: اطمینان حاصل کنید که تنظیمات CORS در بک‌اند به درستی پیکربندی شده است.
2. **خطای احراز هویت**: تازه‌سازی توکن را بررسی کنید.
3. **خطای بارگذاری فایل**: اطمینان حاصل کنید که مسیر `/media/` قابل نوشتن است.

## سناریوهای تست

### سناریو ۱: فرآیند کامل

1. ثبت‌نام یک کاربر جدید
2. ورود به سیستم
3. ایجاد یک طرح جدید
4. مشاهده لیست طرح‌ها
5. مشاهده جزئیات طرح ایجاد شده
6. ویرایش طرح
7. دانلود فایل SVG
8. حذف طرح
9. خروج از سیستم

### سناریو ۲: تست ادمین

1. ورود به عنوان ادمین
2. مشاهده لیست کاربران
3. ایجاد یک کاربر جدید
4. ویرایش کاربر
5. مشاهده طرح‌های تمام کاربران
6. مدیریت طرح‌های سایر کاربران 